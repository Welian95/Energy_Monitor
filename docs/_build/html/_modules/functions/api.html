<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>functions.api &mdash; Energy_Monitor 1.0.0 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Energy_Monitor
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">Energy_monitor Documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Energy_Monitor</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">functions.api</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for functions.api</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>

<span class="n">csv_file_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;example/example_data1.csv&quot;</span>


<span class="c1"># Define the abstract base class</span>
<div class="viewcode-block" id="DataInterface"><a class="viewcode-back" href="../../functions.html#functions.api.DataInterface">[docs]</a><span class="k">class</span> <span class="nc">DataInterface</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Abstract class defining the interface for a data source.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="DataInterface.get_column_names"><a class="viewcode-back" href="../../functions.html#functions.api.DataInterface.get_column_names">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">get_column_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the names of the columns (measurement series labels).</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: A list containing the names of the columns.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="DataInterface.get_time_frequency"><a class="viewcode-back" href="../../functions.html#functions.api.DataInterface.get_time_frequency">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">get_time_frequency</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the time frequency (step size between the individual measurement points).</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: Time frequency as a string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="DataInterface.get_data"><a class="viewcode-back" href="../../functions.html#functions.api.DataInterface.get_data">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_time</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">end_time</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_rows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves data based on various filtering parameters across multiple dimensions:</span>
<span class="sd">        - Columns: By specifying which columns to include.</span>
<span class="sd">        - Rows: By limiting the number of rows to fetch. This can be done in ascending or descending order.</span>
<span class="sd">        - Time: By providing a time range to filter the timestamps.</span>

<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        column_names : list of str, optional</span>
<span class="sd">            List of column names to include in the output DataFrame. If this parameter is None, </span>
<span class="sd">            all columns will be included. The timestamp column is always included.</span>
<span class="sd">        </span>
<span class="sd">        start_time : str or pd.Timestamp, optional</span>
<span class="sd">            The starting timestamp to filter the data. Only data occurring after this timestamp </span>
<span class="sd">            will be included in the output DataFrame. The timestamp should be in a format </span>
<span class="sd">            that can be converted to a pandas Timestamp object. If None, no start time filter is applied.</span>
<span class="sd">            </span>
<span class="sd">        end_time : str or pd.Timestamp, optional</span>
<span class="sd">            The ending timestamp to filter the data. Only data occurring before this timestamp </span>
<span class="sd">            will be included in the output DataFrame. The timestamp should be in a format </span>
<span class="sd">            that can be converted to a pandas Timestamp object. If None, no end time filter is applied.</span>
<span class="sd">        </span>
<span class="sd">        num_rows : int, optional</span>
<span class="sd">            Number of rows to include in the output DataFrame. If ascending is False, the last &#39;num_rows&#39; </span>
<span class="sd">            from the CSV file will be read. Otherwise, the first &#39;num_rows&#39; will be read. </span>
<span class="sd">            If None, all rows will be included.</span>
<span class="sd">            </span>
<span class="sd">        ascending : bool, optional</span>
<span class="sd">            Determines the order in which rows are read from the data source. If True, rows are read in ascending </span>
<span class="sd">            order of their timestamps. If False and &#39;num_rows&#39; is provided, the last &#39;num_rows&#39; are read. </span>
<span class="sd">            Default is True.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        pd.DataFrame</span>
<span class="sd">            A DataFrame containing the filtered data. The DataFrame&#39;s index will be set to the timestamp column.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>


<div class="viewcode-block" id="DataInterface.get_first_timestamp"><a class="viewcode-back" href="../../functions.html#functions.api.DataInterface.get_first_timestamp">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">get_first_timestamp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the first timestamp from the data source.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.Timestamp: The first timestamp.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="DataInterface.get_last_timestamp"><a class="viewcode-back" href="../../functions.html#functions.api.DataInterface.get_last_timestamp">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">get_last_timestamp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the last timestamp from the data source.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.Timestamp: The last timestamp.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div></div>



<span class="c1"># Concrete implementation for InfluxDB </span>
<div class="viewcode-block" id="InfluxDB_DataInterface"><a class="viewcode-back" href="../../functions.html#functions.api.InfluxDB_DataInterface">[docs]</a><span class="k">class</span> <span class="nc">InfluxDB_DataInterface</span><span class="p">(</span><span class="n">DataInterface</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Concrete class implementing the DataInterface for InfluxDB .</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">csv_file_path</span><span class="p">,</span> <span class="n">timestamp_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="n">decimal</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the InfluxDB class.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            filename (str): The path to the CSV file.</span>
<span class="sd">            timestamp_col (int or str): The index or name of the timestamp column.</span>
<span class="sd">            sep (str): The field delimiter for the CSV file. Default is &#39;;&#39;.</span>
<span class="sd">            decimal (str): The decimal separator. Default is &#39;,&#39;.</span>
<span class="sd">            encoding (str): The encoding to use. Default is None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timestamp_col</span> <span class="o">=</span> <span class="n">timestamp_col</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sep</span> <span class="o">=</span> <span class="n">sep</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span> <span class="o">=</span> <span class="n">decimal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span>
    
<div class="viewcode-block" id="InfluxDB_DataInterface.get_column_names"><a class="viewcode-back" href="../../functions.html#functions.api.InfluxDB_DataInterface.get_column_names">[docs]</a>    <span class="k">def</span> <span class="nf">get_column_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the names of the columns from the CSV file.</span>
<span class="sd">        </span>
<span class="sd">        Optimized: Read only the first line to get column names.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="InfluxDB_DataInterface.get_time_frequency"><a class="viewcode-back" href="../../functions.html#functions.api.InfluxDB_DataInterface.get_time_frequency">[docs]</a>    <span class="k">def</span> <span class="nf">get_time_frequency</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the time frequency (step size between the individual measurement points) from the CSV file.</span>
<span class="sd">        </span>
<span class="sd">        Optimized: Start with a smaller number of rows and increase gradually.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>
        
        
    <span class="k">def</span> <span class="nf">_read_csv_reverse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_rows</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read the last &#39;num_rows&#39; lines of the CSV file in reverse order.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: DataFrame containing the last &#39;num_rows&#39; lines, read in reverse order.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>








<div class="viewcode-block" id="InfluxDB_DataInterface.get_data"><a class="viewcode-back" href="../../functions.html#functions.api.InfluxDB_DataInterface.get_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_time</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">end_time</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_rows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves data from the CSV file based on various filtering parameters.</span>
<span class="sd">        This function reads the CSV file in chunks to optimize memory usage and can filter the data based on column names, time range, and number of rows. The function also allows for reading the CSV file in ascending or descending order based on the timestamp.</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        column_names : list of str, optional</span>
<span class="sd">            List of column names to include in the output DataFrame. If this parameter is None, all columns in the CSV file will be included. The timestamp column, defined by the &#39;timestamp_col&#39; attribute, is always included regardless of this parameter.</span>
<span class="sd">        </span>
<span class="sd">        start_time : str or pd.Timestamp, optional</span>
<span class="sd">            The starting timestamp to filter the data. If provided, only the data after this timestamp will be included in the output DataFrame. The string should be in a format that can be converted to a pandas Timestamp object. If this parameter is None, no start time filtering is applied.</span>
<span class="sd">            </span>
<span class="sd">        end_time : str or pd.Timestamp, optional</span>
<span class="sd">            The ending timestamp to filter the data. If provided, only the data before this timestamp will be included in the output DataFrame. The string should be in a format that can be converted to a pandas Timestamp object. If this parameter is None, no end time filtering is applied.</span>
<span class="sd">        </span>
<span class="sd">        num_rows : int, optional</span>
<span class="sd">            The number of rows to include in the output DataFrame. If this parameter is provided along with &#39;ascending=False&#39;, the function will read the last &#39;num_rows&#39; from the CSV file. Otherwise, it will read the first &#39;num_rows&#39; from the file. If this parameter is None, all rows will be included.</span>
<span class="sd">            </span>
<span class="sd">        ascending : bool, optional</span>
<span class="sd">            Determines the order in which rows are read from the CSV file. If True, the rows are read in ascending order based on the timestamp. If False and &#39;num_rows&#39; is provided, the last &#39;num_rows&#39; are read from the file. Default is True.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        pd.DataFrame</span>
<span class="sd">            A DataFrame containing the filtered data from the CSV file. The DataFrame&#39;s index will be set to the timestamp column.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="InfluxDB_DataInterface.get_first_timestamp"><a class="viewcode-back" href="../../functions.html#functions.api.InfluxDB_DataInterface.get_first_timestamp">[docs]</a>    <span class="k">def</span> <span class="nf">get_first_timestamp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the first timestamp from the CSV file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.Timestamp: The first timestamp.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>
        
<div class="viewcode-block" id="InfluxDB_DataInterface.get_last_timestamp"><a class="viewcode-back" href="../../functions.html#functions.api.InfluxDB_DataInterface.get_last_timestamp">[docs]</a>    <span class="k">def</span> <span class="nf">get_last_timestamp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the last timestamp from the CSV file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.Timestamp: The last timestamp.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div></div>
        




<span class="c1"># Concrete implementation for CSV files</span>
<div class="viewcode-block" id="CSVDataInterface"><a class="viewcode-back" href="../../functions.html#functions.api.CSVDataInterface">[docs]</a><span class="k">class</span> <span class="nc">CSVDataInterface</span><span class="p">(</span><span class="n">DataInterface</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Concrete class implementing the DataInterface for CSV files.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">csv_file_path</span><span class="p">,</span> <span class="n">timestamp_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="n">decimal</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the CSVDataInterface class.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            filename (str): The path to the CSV file.</span>
<span class="sd">            timestamp_col (int or str): The index or name of the timestamp column.</span>
<span class="sd">            sep (str): The field delimiter for the CSV file. Default is &#39;;&#39;.</span>
<span class="sd">            decimal (str): The decimal separator. Default is &#39;,&#39;.</span>
<span class="sd">            encoding (str): The encoding to use. Default is None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timestamp_col</span> <span class="o">=</span> <span class="n">timestamp_col</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sep</span> <span class="o">=</span> <span class="n">sep</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">decimal</span> <span class="o">=</span> <span class="n">decimal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span>
    
<div class="viewcode-block" id="CSVDataInterface.get_column_names"><a class="viewcode-back" href="../../functions.html#functions.api.CSVDataInterface.get_column_names">[docs]</a>    <span class="k">def</span> <span class="nf">get_column_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the names of the columns from the CSV file.</span>
<span class="sd">        </span>
<span class="sd">        Optimized: Read only the first line to get column names.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">header_line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">column_names</span> <span class="o">=</span> <span class="n">header_line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sep</span><span class="p">)</span>
        
        <span class="n">timestamp_column</span> <span class="o">=</span> <span class="n">column_names</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamp_col</span><span class="p">]</span>
        <span class="n">column_names</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">timestamp_column</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">column_names</span></div>
    
<div class="viewcode-block" id="CSVDataInterface.get_time_frequency"><a class="viewcode-back" href="../../functions.html#functions.api.CSVDataInterface.get_time_frequency">[docs]</a>    <span class="k">def</span> <span class="nf">get_time_frequency</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the time frequency (step size between the individual measurement points) from the CSV file.</span>
<span class="sd">        </span>
<span class="sd">        Optimized: Start with a smaller number of rows and increase gradually.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">frequency</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">num_rows</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># Starting with a smaller number</span>
        <span class="n">max_attempts</span> <span class="o">=</span> <span class="mi">50</span>
        <span class="n">attempts</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">while</span> <span class="n">frequency</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">attempts</span> <span class="o">&lt;</span> <span class="n">max_attempts</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="n">decimal</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamp_col</span><span class="p">],</span> <span class="n">nrows</span><span class="o">=</span><span class="n">num_rows</span><span class="p">)</span>
            <span class="n">first_column_name</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">df</span><span class="p">[</span><span class="n">first_column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">first_column_name</span><span class="p">])</span>
            <span class="n">frequency</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">infer_freq</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">first_column_name</span><span class="p">])</span>
            <span class="n">attempts</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">num_rows</span> <span class="o">+=</span> <span class="mi">5</span>  <span class="c1"># Increment the number of rows for the next attempt</span>
        
        <span class="k">if</span> <span class="n">frequency</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Could not infer the time frequency of the data.&quot;</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">frequency</span></div>
        
        
    <span class="k">def</span> <span class="nf">_read_csv_reverse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_rows</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read the last &#39;num_rows&#39; lines of the CSV file in reverse order.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: DataFrame containing the last &#39;num_rows&#39; lines, read in reverse order.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">position</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
            <span class="n">line</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;&#39;</span>
            
            <span class="k">while</span> <span class="n">position</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">num_rows</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
                <span class="n">char</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">position</span> <span class="o">-=</span> <span class="mi">1</span>
                
                <span class="k">if</span> <span class="n">char</span> <span class="o">!=</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">char</span> <span class="o">+</span> <span class="n">line</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
                        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;&#39;</span>
        
        <span class="c1"># Create the DataFrame with header=None</span>
        <span class="n">reverse_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])),</span> <span class="n">sep</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamp_col</span><span class="p">)</span>
        <span class="n">reverse_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_column_names</span><span class="p">()</span>
        
        <span class="c1"># Convert the index to datetime</span>
        <span class="n">reverse_df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">reverse_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        
        <span class="c1"># Manually convert columns to float, replacing the decimal separator</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">reverse_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">reverse_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">reverse_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)))</span>
        
        <span class="k">return</span> <span class="n">reverse_df</span>









<div class="viewcode-block" id="CSVDataInterface.get_data"><a class="viewcode-back" href="../../functions.html#functions.api.CSVDataInterface.get_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_time</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">end_time</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_rows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves data from the CSV file based on various filtering parameters.</span>
<span class="sd">        This function reads the CSV file in chunks to optimize memory usage and can filter the data based on column names, time range, and number of rows. The function also allows for reading the CSV file in ascending or descending order based on the timestamp.</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        column_names : list of str, optional</span>
<span class="sd">            List of column names to include in the output DataFrame. If this parameter is None, all columns in the CSV file will be included. The timestamp column, defined by the &#39;timestamp_col&#39; attribute, is always included regardless of this parameter.</span>
<span class="sd">        </span>
<span class="sd">        start_time : str or pd.Timestamp, optional</span>
<span class="sd">            The starting timestamp to filter the data. If provided, only the data after this timestamp will be included in the output DataFrame. The string should be in a format that can be converted to a pandas Timestamp object. If this parameter is None, no start time filtering is applied.</span>
<span class="sd">            </span>
<span class="sd">        end_time : str or pd.Timestamp, optional</span>
<span class="sd">            The ending timestamp to filter the data. If provided, only the data before this timestamp will be included in the output DataFrame. The string should be in a format that can be converted to a pandas Timestamp object. If this parameter is None, no end time filtering is applied.</span>
<span class="sd">        </span>
<span class="sd">        num_rows : int, optional</span>
<span class="sd">            The number of rows to include in the output DataFrame. If this parameter is provided along with &#39;ascending=False&#39;, the function will read the last &#39;num_rows&#39; from the CSV file. Otherwise, it will read the first &#39;num_rows&#39; from the file. If this parameter is None, all rows will be included.</span>
<span class="sd">            </span>
<span class="sd">        ascending : bool, optional</span>
<span class="sd">            Determines the order in which rows are read from the CSV file. If True, the rows are read in ascending order based on the timestamp. If False and &#39;num_rows&#39; is provided, the last &#39;num_rows&#39; are read from the file. Default is True.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        pd.DataFrame</span>
<span class="sd">            A DataFrame containing the filtered data from the CSV file. The DataFrame&#39;s index will be set to the timestamp column.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">all_columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_column_names</span><span class="p">()</span>
        
        <span class="n">result_data_list</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Initialize an empty list to hold the chunks</span>

        <span class="k">if</span> <span class="n">num_rows</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ascending</span><span class="p">:</span>
            <span class="n">result_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_csv_reverse</span><span class="p">(</span><span class="n">num_rows</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">column_names</span><span class="p">:</span>
                <span class="n">result_data</span> <span class="o">=</span> <span class="n">result_data</span><span class="p">[</span><span class="n">column_names</span><span class="p">]</span>

            <span class="n">result_data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;timestamp&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">columns_to_read</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamp_col</span><span class="p">]</span> <span class="k">if</span> <span class="n">column_names</span> <span class="k">else</span> <span class="kc">None</span>
            
            <span class="k">if</span> <span class="n">column_names</span><span class="p">:</span>
                <span class="c1">#index_shift = self.timestamp_col if isinstance(self.timestamp_col, int) else 0</span>
                <span class="n">columns_to_read</span> <span class="o">+=</span> <span class="p">[</span><span class="n">all_columns</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">col</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">column_names</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">all_columns</span><span class="p">]</span>


                
            
            <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="n">decimal</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="n">columns_to_read</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">10000</span><span class="p">):</span>
                <span class="n">first_column_name</span> <span class="o">=</span> <span class="n">chunk</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">chunk</span><span class="p">[</span><span class="n">first_column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">chunk</span><span class="p">[</span><span class="n">first_column_name</span><span class="p">])</span>
                
                
                <span class="k">if</span> <span class="n">start_time</span> <span class="ow">or</span> <span class="n">end_time</span><span class="p">:</span>
                    <span class="n">mask</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">if</span> <span class="n">start_time</span><span class="p">:</span>
                        <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">chunk</span><span class="p">[</span><span class="n">first_column_name</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">start_time</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">end_time</span><span class="p">:</span>
                        <span class="n">mask</span> <span class="o">&amp;=</span> <span class="p">(</span><span class="n">chunk</span><span class="p">[</span><span class="n">first_column_name</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">end_time</span><span class="p">))</span>
                    <span class="n">chunk</span> <span class="o">=</span> <span class="n">chunk</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
                
                <span class="n">result_data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
            
            <span class="n">result_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">result_data_list</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">result_data</span> <span class="o">=</span> <span class="n">result_data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">first_column_name</span><span class="p">)</span>
            <span class="n">result_data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;timestamp&#39;</span>

        
        <span class="k">return</span> <span class="n">result_data</span></div>


<div class="viewcode-block" id="CSVDataInterface.get_first_timestamp"><a class="viewcode-back" href="../../functions.html#functions.api.CSVDataInterface.get_first_timestamp">[docs]</a>    <span class="k">def</span> <span class="nf">get_first_timestamp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the first timestamp from the CSV file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.Timestamp: The first timestamp.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Read only the first row from the CSV</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="n">decimal</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">decimal</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamp_col</span><span class="p">])</span>
        <span class="c1"># Convert the timestamp to a pandas Timestamp object</span>
        <span class="n">timestamp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">timestamp</span></div>

<div class="viewcode-block" id="CSVDataInterface.get_last_timestamp"><a class="viewcode-back" href="../../functions.html#functions.api.CSVDataInterface.get_last_timestamp">[docs]</a>    <span class="k">def</span> <span class="nf">get_last_timestamp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the last timestamp from the CSV file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.Timestamp: The last timestamp.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># Jump to the second last byte</span>
            <span class="k">while</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">last_line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
        
        <span class="n">last_timestamp</span> <span class="o">=</span> <span class="n">last_line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sep</span><span class="p">)[</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamp_col</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">last_timestamp</span><span class="p">)</span></div></div>
















<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">streamlit</span> <span class="k">as</span> <span class="nn">st</span> 
    <span class="c1"># Pfad zum Verzeichnis der aktuellen Datei (api.py) ermitteln</span>
    <span class="n">current_file_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>

    <span class="c1"># Pfad zur CSV-Datei relativ zum aktuellen Verzeichnis setzen</span>
    <span class="n">csv_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">current_file_directory</span><span class="p">,</span> <span class="s1">&#39;../example/example_data1.csv&#39;</span><span class="p">)</span>


    <span class="n">st</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Test of API&quot;</span><span class="p">)</span>
    <span class="c1">#csv_file_path = r&quot;example/example_data1.csv&quot;</span>
    
    <span class="n">csv_file_path</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">text_input</span><span class="p">(</span><span class="s2">&quot;Path to csv-file:&quot;</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="n">csv_file_path</span><span class="p">)</span>
    <span class="n">c1</span><span class="p">,</span><span class="n">c2</span><span class="p">,</span><span class="n">c3</span><span class="p">,</span><span class="n">c4</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">columns</span> <span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">timestamp_col</span><span class="o">=</span><span class="n">c1</span><span class="o">.</span><span class="n">number_input</span><span class="p">(</span><span class="s2">&quot;Index of timestamp column:&quot;</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> 
    <span class="n">sep</span><span class="o">=</span><span class="n">c2</span><span class="o">.</span><span class="n">text_input</span><span class="p">(</span><span class="s2">&quot;CSV seperator:&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">)</span> 
    <span class="n">decimal</span><span class="o">=</span><span class="n">c3</span><span class="o">.</span><span class="n">text_input</span><span class="p">(</span><span class="s2">&quot;Decimal divider:&quot;</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> 
    <span class="n">encoding</span><span class="o">=</span><span class="n">c4</span><span class="o">.</span><span class="n">text_input</span><span class="p">(</span><span class="s2">&quot;CSV encoding&quot;</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">encoding</span> <span class="o">==</span> <span class="s2">&quot;None&quot;</span><span class="p">:</span>
        <span class="n">encoding</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1">#Intitilize CSVDataInterface</span>
    <span class="n">csv_interface</span> <span class="o">=</span> <span class="n">CSVDataInterface</span><span class="p">(</span><span class="n">csv_file_path</span><span class="p">,</span> <span class="n">timestamp_col</span><span class="o">=</span><span class="n">timestamp_col</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">sep</span><span class="p">,</span> <span class="n">decimal</span><span class="o">=</span><span class="n">decimal</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">)</span>  
    
    <span class="c1"># Test the get_column_names method</span>
    <span class="s2">&quot;column_names&quot;</span>
    <span class="n">column_names</span> <span class="o">=</span> <span class="n">csv_interface</span><span class="o">.</span><span class="n">get_column_names</span><span class="p">()</span>
    <span class="n">column_names</span>

    <span class="s2">&quot;time_freq&quot;</span>
    <span class="n">time_freq</span> <span class="o">=</span> <span class="n">csv_interface</span><span class="o">.</span><span class="n">get_time_frequency</span><span class="p">()</span>
    <span class="n">time_freq</span>

    <span class="s2">&quot;data&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">csv_interface</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
    <span class="n">data</span>


    <span class="c1"># Nur die letzte Zeile der CSV-Datei auslesen</span>
    <span class="s2">&quot;last_row&quot;</span>
    <span class="n">last_row</span> <span class="o">=</span> <span class="n">csv_interface</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">num_rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">last_row</span>
 

    <span class="c1"># Nur die letzte Zeile der CSV-Datei auslesen</span>
    <span class="s2">&quot;first_rows&quot;</span>
    <span class="n">first_rows</span> <span class="o">=</span> <span class="n">csv_interface</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">num_rows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">first_rows</span>
    

    <span class="c1"># Nur die erste Spalte der CSV-Datei auslesen</span>
    <span class="s2">&quot;first_column&quot;</span>
    <span class="n">first_column</span> <span class="o">=</span> <span class="n">csv_interface</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">column_names</span><span class="o">=</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
    <span class="n">first_column</span>

    <span class="s2">&quot;filtert_2cols_3rows&quot;</span>
    <span class="n">filtert_2cols_3rows</span> <span class="o">=</span> <span class="n">csv_interface</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">column_names</span><span class="o">=</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">column_names</span><span class="p">[</span><span class="mi">3</span><span class="p">]],</span> <span class="n">num_rows</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">filtert_2cols_3rows</span>

    <span class="s2">&quot;filtert_by_start_date&quot;</span>
    <span class="n">filtert_by_start_date</span> <span class="o">=</span> <span class="n">csv_interface</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">start_time</span><span class="o">=</span><span class="s2">&quot;2020-01-10&quot;</span><span class="p">)</span>
    <span class="n">filtert_by_start_date</span>

    <span class="s2">&quot;filtert_by_end_date&quot;</span>
    <span class="n">end_time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;2020-01-01 03:00:00&quot;</span><span class="p">)</span>
    <span class="n">filtert_by_end_date</span> <span class="o">=</span> <span class="n">csv_interface</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">start_time</span><span class="o">=</span><span class="s2">&quot;2020-01-01 02:20:00&quot;</span> <span class="p">,</span><span class="n">end_time</span><span class="o">=</span><span class="n">end_time</span><span class="p">)</span>
    <span class="n">filtert_by_end_date</span>

    <span class="s2">&quot;first_timestamp&quot;</span>
    <span class="n">first_timestamp</span> <span class="o">=</span> <span class="n">csv_interface</span><span class="o">.</span><span class="n">get_first_timestamp</span><span class="p">()</span>
    <span class="n">first_timestamp</span>

    <span class="s2">&quot;last_timestamp&quot;</span>
    <span class="n">last_timestamp</span> <span class="o">=</span> <span class="n">csv_interface</span><span class="o">.</span><span class="n">get_last_timestamp</span><span class="p">()</span>
    <span class="n">last_timestamp</span>


    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">column_names</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">another_test</span> <span class="o">=</span> <span class="n">csv_interface</span><span class="o">.</span><span class="n">get_data</span><span class="p">([</span><span class="n">column_names</span><span class="p">[</span><span class="mi">6</span><span class="p">]])</span>
    <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">another_test</span><span class="p">)</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Julian W..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>